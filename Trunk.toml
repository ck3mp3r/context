[build]
target = "src/frontend/public/index.html"
dist = "dist"
public_url = "/"
filehash = true
minify = "on_release"
# Disable wasm-opt - cargo already optimizes WASM with opt-level="z"
wasm_opt = "off"
# Use separate target directory to avoid lock contention with outer cargo build
target_dir = "target/trunk"

[watch]
watch = ["src/frontend"]
ignore = ["target", "dist"]

[serve]
addresses = ["127.0.0.1"]
port = 8080
open = true
no_autoreload = false

[[hooks]]
stage = "pre_build"
command = "tailwindcss"
command_arguments = ["-c", "./src/frontend/tailwind/config.js", "-i", "./src/frontend/tailwind/input.css", "-o", "./src/frontend/public/style.css"]

[[proxy]]
backend = "http://localhost:3738"
rewrite = "/dev"

[[proxy]]
backend = "ws://localhost:3738/ws"
rewrite = "/dev/ws"
ws = true
